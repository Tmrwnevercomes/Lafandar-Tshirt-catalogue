<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T-Shirt Brand Catalog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .modal { opacity: 0; visibility: hidden; transition: opacity 300ms ease-out, visibility 0s 300ms; }
        .modal.is-open { opacity: 1; visibility: visible; transition: opacity 300ms ease-out; }
        .modal-content { transform: scale(0.95); transition: transform 300ms ease-out; }
        .modal.is-open .modal-content { transform: scale(1); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #4f46e5; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">T-Shirt Catalog</h1>
            <p class="text-lg text-gray-600 mt-2">Select your options to view stock and add to cart.</p>
        </header>

        <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <div id="loading" class="col-span-full flex justify-center items-center h-64"><div class="loader"></div></div>
        </div>
        
        <!-- All modals and other HTML elements are the same as the previous version -->
    </div>
    
    <!-- All modals are unchanged -->
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        const firebaseConfig = {
  apiKey: "AIzaSyAuO5iyXCHYZS9nS2BViu-259sb2CUSZjo",
  authDomain: "tshirt-catalog-v2.firebaseapp.com",
  projectId: "tshirt-catalog-v2",
  storageBucket: "tshirt-catalog-v2.firebasestorage.app",
  messagingSenderId: "428518895959",
  appId: "1:428518895959:web:8e1fccd4d6f1e2c8b00e12"
};
        // All other JS code is the same as the previous version, with modifications for inventory.
        // For brevity, only the key new/modified functions are shown. The full code is in the downloadable file.

        // --- Key Inventory Functions ---

        function renderProducts() {
            productGrid.innerHTML = '';
            products.forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card bg-white rounded-lg shadow-md overflow-hidden flex flex-col';
                card.dataset.productId = product.id;
                
                const hasVariants = product.variants && Object.keys(product.variants).length > 0;
                const variantOptions = hasVariants ? Object.keys(product.variants).map(name => `<option value="${name}">${name}</option>`).join('') : '';
                const sizeOptions = product.sizes.map(size => `<option value="${size}">${size}</option>`).join('');
                const colorOptions = product.colors.map(color => `<option value="${color}">${color}</option>`).join('');

                card.innerHTML = `
                    <img src="${product.imageUrl}" alt="${product.name}" loading="lazy" class="product-image-clickable w-full h-64 object-cover cursor-pointer">
                    <div class="p-4 flex flex-col flex-grow">
                        <h3 class="text-lg font-semibold">${product.name}</h3>
                        <p class="product-price text-lg font-bold text-gray-800 mb-2">₹--.--</p>
                        
                        <div class="space-y-2 mt-auto pt-2">
                            <select class="product-variant w-full p-2 border border-gray-300 rounded-md"><option value="">Select Category</option>${variantOptions}</select>
                            <div class="grid grid-cols-2 gap-2">
                                <select class="product-size w-full p-2 border border-gray-300 rounded-md"><option value="">Select Size</option>${sizeOptions}</select>
                                <select class="product-color w-full p-2 border border-gray-300 rounded-md"><option value="">Select Color</option>${colorOptions}</select>
                            </div>
                            <div class="stock-info text-sm font-medium text-center h-5"></div>
                        </div>
                        <div class="flex items-center space-x-2 border-t pt-3 mt-3">
                            <input type="number" min="1" value="1" class="quantity-input w-20 p-2 border border-gray-300 rounded-md text-center">
                            <button class="add-to-cart-btn flex-1 bg-indigo-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-indigo-600 transition disabled:opacity-50 disabled:cursor-not-allowed" disabled>Add to Cart</button>
                        </div>
                    </div>
                `;
                productGrid.appendChild(card);
            });
        }

        function updateStockDisplay(cardElement) {
            const productId = cardElement.dataset.productId;
            const product = products.find(p => p.id === productId);
            const variant = cardElement.querySelector('.product-variant').value;
            const size = cardElement.querySelector('.product-size').value;
            const color = cardElement.querySelector('.product-color').value;
            const stockInfo = cardElement.querySelector('.stock-info');
            const priceEl = cardElement.querySelector('.product-price');
            const addBtn = cardElement.querySelector('.add-to-cart-btn');

            priceEl.textContent = variant ? `₹${(product.variants[variant] || 0).toFixed(2)}` : '₹--.--';

            if (variant && size && color) {
                const sku = `${variant}_${size}_${color}`.replace(/\s+/g, '_');
                const stock = product.inventory[sku] || 0;
                
                if (stock > 0) {
                    stockInfo.textContent = `${stock} in stock`;
                    stockInfo.className = 'stock-info text-sm font-medium text-center h-5 text-green-600';
                    addBtn.disabled = false;
                } else {
                    stockInfo.textContent = 'Out of Stock';
                    stockInfo.className = 'stock-info text-sm font-medium text-center h-5 text-red-500';
                    addBtn.disabled = true;
                }
            } else {
                stockInfo.textContent = '';
                addBtn.disabled = true;
            }
        }
        
        // --- Event listeners in productGrid now call updateStockDisplay ---
    </script>
    <!-- The full JS code is included in the downloadable file -->
    <script>
        // Full JS for Customer Catalog with Inventory
        firebase.initializeApp(firebaseConfig);
        // ... (rest of the full JS code)
    </script>
</body>
</html>
